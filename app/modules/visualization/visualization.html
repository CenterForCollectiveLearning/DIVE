<!-- Visualization Nav Bar -->
<visualization-side-nav></visualization-side-nav>

<div class="viz-viewport viewport" layout-fill layout="column" layout-align="starter" flex>
<!-- <div class="viz-viewport viewport" layout-fill flex> -->
  <visualization-preview viz-spec="selectedSpec" viz-type="selectedType" viz-data="vizData" conditional="selCondVals" selected-values="selectedValues"></visualization-preview>
  <div class="visualization" flex="60" layout="row" ng-if="selectedSpec.category !== 'comparison'">
    <div class="left-side card" layout="column" flex>
      <md-progress-linear md-mode="indeterminate" ng-if="loadingViz" flex></md-progress-linear>
      <div id="viz-container" flex></div>
      <div class="legend" ng-if="selectedSpec.category === 'time series'" layout="row" layout-align="center center"></div>
    </div>
    <div class="stats card" ng-if="selectedSpec.category === 'time series'" flex="30">
      <visualization-stats></visualization-stats>
    </div>
  </div>
  
  <div class="scroll" flex="40">
    <div class="parameters card" ng-if="selectedSpec.category === 'comparison'" flex>
      <div class="title">Parameters</div>
<!--       {{vizData}}
      {{vizStats}}
      {{selectedParameters}}
      {{parametersData}} -->
      <!-- Matrix of scatterplots for comparison selection -->
<!--       <div class="scatterplots" layout="row" layout-wrap flex>
        <div ng-repeat="(entities, comparison) in vizData" class="scatterplot-container" flex="20">
        <div id="scatterplot-{{$index}}" class="scatterplot"></div>
        <scatterplot data="comparison" entities="entities" selector="#scatterplot-{{$index}}"></scatterplot>
        </div>
      </div> -->

      <ul class="dropdowns">
        <li>
          <label class="dropdown-label">Compare by</label>
          <md-select 
            ng-if="condList"
            ng-model="parameters.compareBy" 
            ng-change="refreshVizData()"
          >
            <md-option ng-repeat="c in condList track by $index" ng-if="c !== selectedSpec.compare.title">{{c.name}}</md-option>
          </md-select>
        </li>
        <li>
          <label class="dropdown-label">X Variable</label>
          <md-select
            ng-if="parametersData"
            ng-model="selectedParameters.x"
            ng-change="refreshVizData()"
          >
            <md-option ng-repeat="p in parametersData">{{p}}</md-option>
          </md-select>
        </li>
        <li>
          <label class="dropdown-label">Y Variable</label>
          <md-select 
            ng-if="parametersData"
            ng-model="selectedParameters.y" 
            ng-change="refreshVizData()"
          >
            <md-option ng-repeat="p in parametersData">{{p}}</md-option>
          </md-select>
        </li>
        <li>
          <label class="dropdown-label">Group By</label>
          <md-select 
            ng-if="condList"
            ng-model="parameters.group.by" 
            ng-change="refreshVizData()"
          >
            <md-option ng-repeat="c in condList track by $index">{{c.name}}</md-option>
          </md-select>
        </li>
      </ul>
    </div>

    <div class="conditionals card" flex>
      <visualization-conditionals></visualization-conditionals>
    </div>

    <div class="grouping card" flex>
      <visualization-grouping></visualization-grouping>
    </div>

    <div class="configurations card" flex>
      <div class="title">Configuration</div>
      <section layout="row" layout-sm="column" layout-align="center center">
        <md-checkbox ng-model="config.normalize">Normalize</md-checkbox>
      </section>
      <!-- Filter UI -->
<!--       <md-select
        ng-if="parametersData"
        ng-model="selectedParameters.x"
        ng-change="refreshVizData()"
      >
        <md-option ng-repeat="p in parametersData">{{p}}</md-option>
      </md-select> -->
    </div>
    <div class="export card" flex>
      <visualization-export></visualization-export>
  </div>
</div>