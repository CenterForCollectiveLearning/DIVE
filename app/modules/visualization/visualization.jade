md-whiteframe.main-container.md-whiteframe-z2(layout='row', layout-fill='')
  // Visualization Nav Bar

  .viz-viewport(layout-fill='', layout='column', layout-align='starter', flex='')
    visualization-preview(viz-spec='selectedSpec', viz-type='selectedType', viz-data='vizData', conditional='selCondVals', selected-values='selectedValues')

    md-toolbar.segmentation-block(ng-class="{'extended': selectedVectorY}")
      .md-toolbar-tools
        h3.category-title
          span Visualize
        md-autocomplete(md-items="d in datasets", md-item-text="d.title", placeholder="dataset", md-min-length="0", md-search-text="datasetQuery", md-selected-item="dataset")
          md-item-template
            span(md-highlight-text="datasetQuery") {{d.title}}

        span by
        md-autocomplete(md-items="vector in getVectors()", md-item-text="vector.name", placeholder="variable y", md-min-length="0", md-search-text="searchQueryY", md-selected-item="selectedVectorY")
          md-item-template
            span(md-highlight-text="searchQueryY") {{vector.name}}

        .second-segment-selector(ng-if="selectedVectorY")
          span vs
          md-autocomplete(md-items="vector in getVectors()", md-item-text="vector.name", placeholder="variable x", md-min-length="0", md-search-text="searchQueryX")
            md-item-template
              span(md-highlight-text="searchQueryX") {{vector.name}}


    .toolbar-extension(ng-if="selectedVectorY")
      .toolbar-extension-component(layout='row')
        h3.category-title
          span Conditionals

        md-autocomplete(md-items="vector in getVectors()", md-item-text="vector.name", placeholder="field", md-min-length="0", md-search-text="conditionalFieldQuery", md-selected-item="conditionalField")
          md-item-template
            span(md-highlight-text="conditionalField") {{vector.name}}

        md-autocomplete(ng-disabled='!conditionalField', md-items="vector in getVectors()", md-item-text="vector.name", placeholder="operator", md-min-length="0", md-search-text="conditionalOperatorQuery", md-selected-item="conditionalOperator")
          md-item-template
            span(md-highlight-text="conditionalOperator") {{vector.name}}

        md-autocomplete(ng-disabled='!conditionalOperator', md-items="vector in getVectors()", md-item-text="vector.name", placeholder="value", md-min-length="0", md-search-text="conditionalValueQuery", md-selected-item="conditionalValue")
          md-item-template
            span(md-highlight-text="conditionalValue") {{vector.name}}


    md-content(flex='', layout='column')
      .visualization(flex='', layout='row', ng-if="selectedSpec.category !== 'comparison'")
        .left-side(layout='column', flex='')
          md-progress-linear(md-mode='indeterminate', ng-if='loadingViz', flex='')
          #viz-container(flex='')
          .legend(ng-if="selectedSpec.category === 'time series'", layout='row', layout-align='center center')
        md-card.stats(ng-if="selectedSpec.category === 'time series'", flex='30')
          md-card-content
            visualization-stats

      .visualization-datatable(ng-if='vizData', flex='')
        .datatable
        table(data='vizData', selector="'.datatable'", headers='headers', rowheader='false', height=1000, sortindex=1, sortorder='false')

      .visualization-options-block
        md-card.parameters.flat(ng-if="selectedSpec.category === 'comparison'", flex='')
          md-card-content
            h2.md-title Parameters
            ul.dropdowns
              li
                label.dropdown-label Compare by
                md-select(ng-if='condList', ng-model='parameters.compareBy', ng-change='refreshVizData()')
                  md-option(ng-repeat='c in condList track by $index', ng-if='c !== selectedSpec.compare.title') {{c.name}}
              li
                label.dropdown-label X Variable
                md-select(ng-if='parametersData', ng-model='selectedParameters.x', ng-change='refreshVizData()')
                  md-option(ng-repeat='p in parametersData') {{p}}
              li
                label.dropdown-label Y Variable
                md-select(ng-if='parametersData', ng-model='selectedParameters.y', ng-change='refreshVizData()')
                  md-option(ng-repeat='p in parametersData') {{p}}
              li
                label.dropdown-label Group By
                md-select(ng-if='condList', ng-model='parameters.group.by', ng-change='refreshVizData()')
                  md-option(ng-repeat='c in condList track by $index') {{c.name}}
                
