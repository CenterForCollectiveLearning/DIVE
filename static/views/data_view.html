<engine-top-bar></engine-top-bar>

<!-- TODO: Refactor these into directives? -->
<section class="left-pane" ng-class="{'closed': leftClosed}">
  <div class="pane-title">
    Choose Data Sources
  </div>
  <ul class="pane-items">
    <li ng-repeat="option in options" class="option" ng-class="{'selected':$index==selectedIndex && currentPane=='left'}">
      <div class="vertical-center title" ng-click="select_option($index)" ng-class="{'inactive': option.inactive}">{[{option.label}]}</div>
    </li>
  </ul>
</section>

<section class="right-pane" ng-class="{'closed': rightClosed}">
  <div class="pane-title">
    Inspect Datasets
  </div>
  <ul class="pane-items">
    <li ng-repeat="dataset in datasets" class="dataset" ng-click="select_dataset($index)" ng-class="{'selected':$index==selectedIndex && currentPane=='right'}">
      <div class="title">{[{dataset.title}]}</div>
      <div class="dimensions">
        <span class="rows">{[{dataset.rows}]} Rows</span> x <span class="columns">{[{dataset.cols}]} Columns</span>
      </div>
      <div class="type">{[{dataset.filetype}]}</div>
    </li>
  </ul>
</section>

<section class="viewport" ng-class="{'right-closed': rightClosed, 'left-closed': leftClosed}">
  <pane-toggle></pane-toggle>

  <div class="choose-data-set" ng-if="currentPane=='left'">
    <!-- File Upload UI -->
    <div class="file-upload" ng-if="selectedIndex==0">
      <div class="button upload" ng-file-select="onFileSelect($files)" data-multiple="true">Upload Files from Computer</div>
      <div class="button cancel" ng-click="upload.abort()">Cancel Upload</div>
      <div class="drop" ng-file-drop="onFileSelect($files)" ng-file-drag-over-class="dropped-file"
        ng-show="dropSupported">Drop files here</div>
      <div ng-file-drop-available="dropSupported=true" ng-show="!dropSupported">HTML5 Drop File is not supported!</div>

    </div>
  </div>

  <!-- TODO Change depending on which pane is active-->
  <div ng-repeat="dataset in datasets" ng-if="$index==selectedIndex && currentPane=='right'">
    <div class="dataset-preview" ng-if="dataset.sample">
      <input type="text" ng-model="dataset.title">
      <table>
        <tr>
          <td ng-repeat="attr in dataset.column_attrs">    
            <input type="text" ng-model="attr.name">
          </td>
        </tr>
        <tr>
          <td ng-repeat="attr in dataset.column_attrs">
            <select ng-model="attr.type" ng-options="type for type in types" class="type-select">
          </td>
        </tr>

       <tr ng-repeat="(index, row) in dataset.sample">
          <td ng-repeat="elem in row"> {[{elem}]} </td>
        </tr>
      </table>
    </div>
  </div>
</section>